<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>NEW YEAR CARD for My GF</title>

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@700;800&display=swap" rel="stylesheet">

<style>
  *{ box-sizing:border-box; margin:0; padding:0; }
  body{
    min-height:100vh;
    display:grid;
    place-items:center;
    font-family:"Montserrat",system-ui,sans-serif;
    overflow:hidden;
    background:#0b1020;
    color:#eaf2ff;
  }

  #muteBtn{
    position:fixed;
    right:14px;
    top:14px;
    z-index:99;
    padding:10px 12px;
    border-radius:12px;
    border:0;
    background:rgba(255,255,255,.12);
    color:#fff;
    font-weight:800;
    backdrop-filter: blur(10px);
    cursor:pointer;
  }

  #fireworks{
    position:fixed; inset:0;
    width:100%; height:100%;
    z-index:0;
    pointer-events:none;
  }

  .stars{
    position:fixed; inset:-40px;
    z-index:-1;
    background:
      radial-gradient(circle at 20% 30%, rgba(255,255,255,.18) 1px, transparent 2px),
      radial-gradient(circle at 70% 60%, rgba(255,255,255,.14) 1px, transparent 2px),
      radial-gradient(circle at 40% 80%, rgba(255,255,255,.10) 1px, transparent 2px),
      radial-gradient(circle at 80% 20%, rgba(255,255,255,.12) 1px, transparent 2px),
      radial-gradient(circle at 10% 70%, rgba(255,255,255,.11) 1px, transparent 2px);
    background-size: 240px 240px, 320px 320px, 420px 420px, 360px 360px, 520px 520px;
    animation: drift 18s linear infinite;
    filter: blur(.15px);
    pointer-events:none;
  }
  @keyframes drift{
    from { background-position: 0 0, 0 0, 0 0, 0 0, 0 0; }
    to   { background-position: 240px 160px, -260px 220px, 180px -260px, -260px -120px, 240px 300px; }
  }

  .scene{
    position:relative;
    width:min(760px, 96vw);
    height:720px;
    padding: 0 18px;
    display:grid;
    place-items:center;
    z-index:1;
    overflow: visible;
  }

  .header{
    position:absolute;
    top:34px;
    width:100%;
    text-align:center;
    user-select:none;
    text-shadow: 0 16px 44px rgba(0,0,0,.55);
  }
  .header .t1{
    font-weight:800;
    letter-spacing:.2px;
    line-height:1.05;
    color:#eaf2ff;
    font-size: clamp(30px, 4.4vw, 56px);
  }
  .header .t2{
    margin-top:6px;
    font-weight:800;
    letter-spacing:.2px;
    line-height:1.05;
    color:#eaf2ff;
    font-size: clamp(26px, 3.9vw, 50px);
    opacity:.98;
  }

  .wrap{
    position:relative;
    width:min(360px, 92vw);
    height:520px;
    display:grid;
    place-items:center;
    cursor:pointer;
    user-select:none;
    filter: drop-shadow(0 22px 35px rgba(0,0,0,.55));
    animation: float 2.2s ease-in-out infinite;
    transform: translateY(70px);
  }
  @keyframes float{
    0%,100%{ transform: translateY(70px); }
    50%{ transform: translateY(54px); }
  }

  .confetti{
    position:absolute;
    left:50%;
    bottom:140px;
    width:1px; height:1px;
    pointer-events:none;
    z-index:90;
  }
  .piece{
    position:absolute; left:0; top:0;
    border-radius:999px;
    opacity:0;
    will-change: transform, opacity;
  }

  /* ================== ENVELOPE ================== */
  .envelope{
    position:absolute;
    bottom:140px;
    width:320px;
    height:200px;
    border-radius:14px;
    background: linear-gradient(180deg, #1b2a56, #111a38);
    overflow:visible;
    isolation:isolate;
    z-index:10;

    perspective: 1000px;
    transform-style: preserve-3d;
  }
  .envelope::before{
    content:"";
    position:absolute; inset:10px;
    border-radius:12px;
    border:1px solid rgba(255,255,255,.08);
    box-shadow: inset 0 0 0 1px rgba(0,0,0,.22);
    pointer-events:none;
    z-index:60;
  }

  .backFlap{
    position:absolute;
    left:0; right:0; top:0;
    height:58%;
    background: linear-gradient(180deg, #273a74, #1a2750);
    clip-path: polygon(0 0, 100% 0, 50% 100%);
    opacity:.95;
    z-index:11;
    transform: translateZ(0.1px);
  }

  .frontFlap{
    position:absolute;
    left:0; right:0; top:0;
    height:62%;
    background: linear-gradient(180deg, #3a56b5, #22357a);
    clip-path: polygon(0 0, 100% 0, 50% 100%);
    transform-origin: 50% 0%;
    transform: rotateX(0deg) translateZ(2px);
    transition: transform .85s cubic-bezier(.2,.95,.2,1);
    z-index:40;
    backface-visibility:hidden;
    transform-style:preserve-3d;
  }

  .frontFlap .seal{
    position:absolute;
    left:50%;
    top: 88px;
    width:22px;
    height:22px;
    border-radius:50%;
    transform: translateX(-50%);
    background: radial-gradient(circle at 30% 30%, #ffeaa6, #f0b400);
    box-shadow: 0 10px 18px rgba(0,0,0,.35);
    z-index:80;
    backface-visibility:hidden;
    -webkit-transform: translateZ(0) translateX(-50%);
  }
  .frontFlap .seal::after{
    content:"";
    position:absolute;
    inset:6px;
    border-radius:50%;
    background: rgba(255,255,255,.16);
  }

  .front{
    position:absolute;
    left:0; right:0; bottom:0;
    height:62%;
    background: linear-gradient(180deg, #16214a, #0f1738);
    clip-path: polygon(0 0, 50% 55%, 100% 0, 100% 100%, 0 100%);
    z-index:25;
    transform: translateZ(1px);
  }

  .maskSeal{
    position:absolute;
    left:0; right:0; top:0;
    height:52%;
    background: linear-gradient(180deg, #1b2a56, #131d40);
    z-index:30;
    opacity:1;
    transition: opacity .18s linear;
    pointer-events:none;
  }

  /* ================== CARD ================== */
  .card{
    position:absolute;
    width:min(290px, 86vw);
    height:310px;
    left:50%;
    bottom:170px;

    transform: translateX(-50%) translateY(320px);
    opacity:0;

    border-radius:14px;
    background: linear-gradient(180deg, #ffffff, #eef3ff);
    color:#0c1736;
    box-shadow: 0 18px 30px rgba(0,0,0,.22);
    overflow:hidden;

    display:flex;
    flex-direction:column;

    z-index:20;
    pointer-events:none;
  }

  .cardHead{
    padding:14px 16px 10px 16px;
    border-bottom:1px solid rgba(10,20,60,.08);
    display:flex;
    align-items:baseline;
    justify-content:space-between;
    flex:0 0 auto;
  }
  .year{ font-weight:800; font-size:18px; letter-spacing:1px; }
  .tag{
    font-size:11px;
    font-weight:800;
    color:#2a3a77;
    background: rgba(42,58,119,.09);
    padding:6px 10px;
    border-radius:999px;
  }

  .message{
    padding: 12px 16px 0 16px;
    font-size: 13px;
    font-weight:700;
    line-height: 1.38;
    white-space: pre-line;
    flex: 1 1 auto;
  }

  /* âœ… FIX (stable): align bottom edge, then micro-tune SVG */
  .loveLine{
    display:flex;
    justify-content:flex-end;
    align-items:flex-end;   /* âœ… key: text + svg share same bottom */
    gap:8px;
    margin-top: 8px;
    font-weight:800;
    line-height:1;          /* âœ… keep line box tight */
  }

  .heart{
    width:22px;
    height:22px;
    flex:0 0 auto;
    display:block;          /* âœ… remove inline SVG baseline behavior */
    position:relative;
    top:1px;                /* âœ… micro-tune: try 0px/1px/2px if needed */
    filter:
      drop-shadow(0 4px 10px rgba(180,80,255,.35))
      drop-shadow(0 0 12px rgba(255,60,200,.25));
  }

  .signature{
    margin: 2px 16px 0 16px;
    font-size: 12px;
    font-weight:800;
    opacity:.9;
    flex:0 0 auto;
  }

  .cta{
    margin: 6px 16px 12px 16px;
    height:40px;
    border-radius:12px;
    display:grid;
    place-items:center;
    font-weight:800;
    font-size:12px;
    color:#ffffff;
    background: linear-gradient(180deg, #27d46d, #12b85a);
    box-shadow: 0 10px 18px rgba(18,184,90,.28);
    flex:0 0 auto;
  }

  .wrap.open{ animation:none; }

  .wrap.open .frontFlap{
    transform: rotateX(170deg) translateZ(2px);
  }
  .wrap.open .maskSeal{
    opacity:0;
  }

  @keyframes cardUpFront {
    0%   { transform: translateX(-50%) translateY(320px); opacity:0; }
    40%  { transform: translateX(-50%) translateY(320px); opacity:0; }
    70%  { transform: translateX(-50%) translateY(-210px); opacity:1; }
    100% { transform: translateX(-50%) translateY(-185px); opacity:1; }
  }
  .wrap.open .card{
    animation: cardUpFront .95s cubic-bezier(.12,.95,.12,1) forwards;
    z-index:50;
  }

  .wrap:not(.open) .card{
    animation:none;
    opacity:0;
    transform: translateX(-50%) translateY(320px);
  }

  @media (prefers-reduced-motion: reduce){
    .stars, .wrap { animation:none !important; }
    .frontFlap{ transition:none !important; }
    .wrap.open .card{ animation:none !important; opacity:1; transform: translateX(-50%) translateY(-185px); }
  }
</style>
</head>

<body>
  <button id="muteBtn" type="button">ðŸ”Š Music</button>

  <canvas id="fireworks"></canvas>
  <div class="stars"></div>

  <audio id="bgm" src="jingle-bells-445113.mp3" preload="auto" loop></audio>

  <div class="scene">
    <div class="header">
      <div class="t1">NEW YEAR CARD</div>
      <div class="t2">for My GF</div>
    </div>

    <div class="wrap" id="wrap" aria-label="Open envelope">
      <div class="confetti" id="confetti"></div>

      <div class="card" aria-hidden="true">
        <div class="cardHead">
          <div class="year">2026</div>
          <div class="tag">To My Dear</div>
        </div>

        <div class="message">
To my Dear,
Thank you for coming into my life.
You belike a star shining on
the top of the chrismas tree.

<div class="loveLine">
  I love u
  <svg class="heart" viewBox="0 0 24 24" aria-hidden="true">
    <defs>
      <linearGradient id="gPurple" x1="0" y1="0" x2="0.9" y2="1">
        <stop offset="0%"   stop-color="#4B1EFF"/>
        <stop offset="45%"  stop-color="#7B2CFF"/>
        <stop offset="75%"  stop-color="#C42CFF"/>
        <stop offset="100%" stop-color="#FF2DAA"/>
      </linearGradient>
    </defs>
    <path fill="url(#gPurple)" d="M12 21s-7-4.35-9.33-8.53C.44 8.9 2.2 6 5.4 6c1.76 0 3.07.86 3.9 2.02C10.13 6.86 11.44 6 13.2 6c3.2 0 4.96 2.9 2.73 6.47C19 16.65 12 21 12 21z"/>
  </svg>
</div>
        </div>

        <div class="signature">â€” From Korn Sud Lor âœ¨</div>
        <div class="cta">Happy New Year â™¥</div>
      </div>

      <div class="envelope">
        <div class="backFlap"></div>
        <div class="maskSeal"></div>

        <div class="frontFlap">
          <div class="seal" aria-hidden="true"></div>
        </div>

        <div class="front"></div>
      </div>
    </div>
  </div>

<script>
  // ================= Helpers =================
  const wrap = document.getElementById('wrap');
  const confettiRoot = document.getElementById('confetti');

  function rand(min, max){ return Math.random() * (max - min) + min; }
  function pick(arr){ return arr[Math.floor(Math.random() * arr.length)]; }

  // ================= Confetti (particles) =================
  function burstConfetti(){
    confettiRoot.innerHTML = "";
    const colors = ["#ffd54d", "#ffcc00", "#ffffff", "#ffeaa6"];
    const count = 140;

    for(let i=0;i<count;i++){
      const p = document.createElement("span");
      p.className = "piece";

      const size = rand(4, 7);
      p.style.width = size + "px";
      p.style.height = size + "px";
      p.style.background = pick(colors);

      const startX = rand(-8, 8);
      const startY = rand(-8, 8);

      const angle = rand(-Math.PI, Math.PI);
      const radius = rand(70, 220);
      const endX = Math.cos(angle) * radius * rand(0.75, 1.1);
      const endY = Math.sin(angle) * radius * rand(0.75, 1.1) + rand(90, 300);

      const rotate = rand(-900, 900);
      const duration = rand(1700, 2700);
      const delay = rand(0, 160);

      confettiRoot.appendChild(p);

      p.animate([
        { transform: `translate(${startX}px, ${startY}px) scale(1)`, opacity: 0 },
        { transform: `translate(${startX + endX*0.35}px, ${startY + endY*0.35}px) rotate(${rotate*0.35}deg) scale(1)`, opacity: 1, offset: 0.25 },
        { transform: `translate(${startX + endX}px, ${startY + endY}px) rotate(${rotate}deg) scale(0.9)`, opacity: 0 }
      ], {
        duration,
        delay,
        easing: "cubic-bezier(.16,.9,.22,1)",
        fill: "forwards"
      });

      setTimeout(() => p.remove(), duration + delay + 220);
    }
  }

  // ================= Fireworks (streak/line style) =================
  const canvas = document.getElementById('fireworks');
  const ctx = canvas.getContext('2d', { alpha: true });

  let W = 0, H = 0;
  function resize(){
    const dpr = Math.max(1, Math.min(2, window.devicePixelRatio || 1));
    W = Math.floor(window.innerWidth);
    H = Math.floor(window.innerHeight);
    canvas.width = Math.floor(W * dpr);
    canvas.height = Math.floor(H * dpr);
    canvas.style.width = W + 'px';
    canvas.style.height = H + 'px';
    ctx.setTransform(dpr, 0, 0, dpr, 0, 0);
  }
  window.addEventListener('resize', resize);
  resize();

  let sparks = [];
  let runningFW = false;
  let stopAt = 0;

  function spawnLineFirework(x, y){
    const colors = ['#ffd54d', '#ffffff', '#ffcc00', '#ffeaa6', '#7B2CFF', '#FF2DAA'];
    const n = Math.floor(rand(55, 90));
    const base = pick(colors);

    for(let i=0;i<n;i++){
      const a = rand(0, Math.PI * 2);
      const s = rand(2.2, 5.8);
      sparks.push({
        x, y,
        vx: Math.cos(a) * s,
        vy: Math.sin(a) * s - rand(0, 2.0),
        life: rand(55, 95),
        color: base,
        w: rand(1.15, 1.9),
        tail: rand(7, 15)
      });
    }
  }

  function startFireworks(){
    runningFW = true;
    stopAt = performance.now() + 2600;
    if(sparks.length === 0) ctx.clearRect(0,0,W,H);

    for(let i=0;i<6;i++){
      spawnLineFirework(rand(W*0.15, W*0.85), rand(H*0.12, H*0.42));
    }
    requestAnimationFrame(tickFW);
  }

  function stopFireworks(){
    runningFW = false;
    sparks.length = 0;
    ctx.clearRect(0,0,W,H);
  }

  function tickFW(t){
    if(!runningFW) return;

    ctx.fillStyle = 'rgba(11,16,32,0.10)';
    ctx.fillRect(0,0,W,H);
    ctx.globalCompositeOperation = 'lighter';

    const g = 0.055;
    for(let i=sparks.length-1;i>=0;i--){
      const p = sparks[i];
      p.vy += g;
      p.x += p.vx;
      p.y += p.vy;
      p.life -= 1;

      const alpha = Math.max(0, Math.min(1, p.life / 80));
      ctx.globalAlpha = alpha;
      ctx.strokeStyle = p.color;
      ctx.lineWidth = p.w;
      ctx.lineCap = 'round';

      const tx = p.x - p.vx * (p.tail * 0.18);
      const ty = p.y - p.vy * (p.tail * 0.18);

      ctx.beginPath();
      ctx.moveTo(tx, ty);
      ctx.lineTo(p.x, p.y);
      ctx.stroke();

      if(p.life <= 0) sparks.splice(i,1);
    }

    ctx.globalAlpha = 1;
    ctx.globalCompositeOperation = 'source-over';

    if(t < stopAt && Math.random() < 0.10){
      spawnLineFirework(rand(W*0.2, W*0.8), rand(H*0.12, H*0.42));
    }

    if(t >= stopAt && sparks.length === 0){
      runningFW = false;
      ctx.clearRect(0,0,W,H);
      return;
    }
    requestAnimationFrame(tickFW);
  }

  // ================= Background Music (open/close sync) =================
  const bgm = document.getElementById('bgm');
  const muteBtn = document.getElementById('muteBtn');

  let isMuted = false;
  let fadeRAF = null;

  bgm.loop = true;
  bgm.volume = 0.0;

  function cancelFade(){
    if(fadeRAF) cancelAnimationFrame(fadeRAF);
    fadeRAF = null;
  }

  function fadeTo(target=0.35, ms=900, onDone){
    cancelFade();
    const start = bgm.volume;
    const t0 = performance.now();

    function step(t){
      const p = Math.min(1, (t - t0) / ms);
      bgm.volume = start + (target - start) * p;
      if(p < 1){
        fadeRAF = requestAnimationFrame(step);
      }else{
        fadeRAF = null;
        if(typeof onDone === "function") onDone();
      }
    }
    fadeRAF = requestAnimationFrame(step);
  }

  function playMusic(){
    if(isMuted) return;
    bgm.play().catch(()=>{});
  }

  function stopMusic(){
    bgm.pause();
    bgm.currentTime = 0;
  }

  function musicOpen(){
    playMusic();
    fadeTo(0.35, 900);
  }

  function musicClose(){
    fadeTo(0.0, 650, () => stopMusic());
  }

  muteBtn.addEventListener('click', (e)=>{
    e.stopPropagation();
    isMuted = !isMuted;
    bgm.muted = isMuted;
    muteBtn.textContent = isMuted ? "ðŸ”‡ Music" : "ðŸ”Š Music";

    if(!isMuted && wrap.classList.contains('open')){
      musicOpen();
    }
    if(isMuted){
      cancelFade();
      stopMusic();
      bgm.volume = 0.0;
    }
  });

  // ================= Click behavior =================
  function openEnvelope(){
    wrap.classList.add('open');
    burstConfetti();
    startFireworks();
    musicOpen();
  }

  function closeEnvelope(){
    wrap.classList.remove('open');
    stopFireworks();
    musicClose();
  }

  wrap.addEventListener('click', () => {
    if(wrap.classList.contains('open')){
      closeEnvelope();
    }else{
      openEnvelope();
    }
  });
</script>
</body>
</html>
